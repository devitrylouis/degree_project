{
    "collab_server" : "",
    "contents" : "quadratic_predictors <- function(df)\n{\n  names <- character()\n\n  predictors = c(\"MSSubClass\",\"LotFrontage\",\"LotArea\",\"OverallQual\",\"OverallCond\"\n                   ,\"YearBuilt\",\"YearRemodAdd\",\"MasVnrArea\",\"BsmtFinSF1\",\"BsmtFinSF2\",\"BsmtUnfSF\",\"1stFlrSF\",\"2ndFlrSF\"\n                   ,\"LowQualFinSF\",\"BsmtFullBath\",\"BsmtHalfBath\",\"FullBath\",\"HalfBath\",\"BedroomAbvGr\"\n                   ,\"KitchenAbvGr\",\"TotRmsAbvGrd\",\"GarageYrBlt\",\"GarageCars\",\"GarageArea\",\"WoodDeckSF\",\"OpenPorchSF\",\"EnclosedPorch\"\n                   ,\"3SsnPorch\",\"ScreenPorch\",\"PoolArea\",\"MoSold\",\"YrSold\")\nj<-0\nwhile(length(predictors)>0)\n  {\nj<-j+1\n    p_value<-numeric(length(predictors))\n    significance <- logical(length(predictors))\n    for (i in 1:length(predictors)) \n    {\n      fit1 <- lm(df$SalePrice ~.,data=df)\n      fit2 <- lm(df$SalePrice ~. +poly(df[[ predictors[i] ]],2,raw=TRUE) ,data=df)\n      anov<-anova(fit1,fit2)\n      p_value[i]<-anov$`Pr(>F)`[2]\n      if(p_value[i]<=0.01)\n      {\n        significance[i]<-TRUE\n      }\n    }\n    \n    # Predictor higher term with the lowest p-value\n    \n    names[j] <- predictors[which.min(p_value)]\n    \n    # Predictors of interest are kept\n    \n    indices <- c(which.min(p_value), which(significance==FALSE))\n    \n    predictors <- predictors[-indices]\n    \n    # Add the most significant to the data frame\n    \n    df[[paste(names[j],\"2\")]] <- df[[names[j]]]^2 ### Concatenate name\n  }\n  \n  return(df)\n}\n",
    "created" : 1492254655832.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3363631990",
    "id" : "B1A99016",
    "lastKnownWriteTime" : 1492254648,
    "last_content_update" : 1492254648,
    "path" : "~/Documents/Education/KTH/Bachelor thesis/Bachelor Thesis/Higher Terms/quadratic_predictors.R",
    "project_path" : "Higher Terms/quadratic_predictors.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}